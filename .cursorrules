# AWS S3 Upload MCP Server - Cursor Rules

## ğŸ¯ í”„ë¡œì íŠ¸ ê°œìš”
ì´ í”„ë¡œì íŠ¸ëŠ” Figma â†’ MCP â†’ HTML â†’ Cursor Rules ì›Œí¬í”Œë¡œìš°ì—ì„œ ì´ë¯¸ì§€ íŒŒì¼ë“¤ì„ AWS S3ì— ìë™ ì—…ë¡œë“œí•˜ëŠ” MCP ì„œë²„ë¥¼ ê°œë°œí•©ë‹ˆë‹¤.

## ğŸ—ï¸ ê¸°ìˆ  ìŠ¤íƒ
- **ì–¸ì–´**: Python 3.10+
- **MCP í”„ë ˆì„ì›Œí¬**: `fastmcp` (ê³ ì„±ëŠ¥ Pythonic MCP ë¼ì´ë¸ŒëŸ¬ë¦¬)
- **AWS SDK**: `boto3`
- **ì´ë¯¸ì§€ ì²˜ë¦¬**: `Pillow` (PIL)
- **ë¹„ë™ê¸° ì²˜ë¦¬**: `asyncio`, `aiohttp`
- **íƒ€ì… ê²€ì¦**: `pydantic` (FastMCP ë‚´ì¥)
- **íŒ¨í‚¤ì§€ ê´€ë¦¬**: `uv` (ê¶Œì¥)

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°
```
s3-upload-mcp-server/
â”œâ”€â”€ pyproject.toml
â”œâ”€â”€ README.md
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ s3_upload_mcp/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ server.py          # MCP ì„œë²„ ë©”ì¸
â”‚   â”‚   â”œâ”€â”€ tools.py           # MCP Tools êµ¬í˜„
â”‚   â”‚   â”œâ”€â”€ image_processor.py # ì´ë¯¸ì§€ ì²˜ë¦¬ ë¡œì§
â”‚   â”‚   â””â”€â”€ s3_client.py       # S3 í´ë¼ì´ì–¸íŠ¸ ë˜í¼
â”œâ”€â”€ tests/
â”œâ”€â”€ config/
â”‚   â””â”€â”€ claude_desktop_config.json
â””â”€â”€ docs/
```

## ğŸ”§ í•µì‹¬ FastMCP Tools êµ¬í˜„

### 1. upload_image_to_s3
```python
from fastmcp import FastMCP, Context
from pydantic import BaseModel
from typing import Optional

class UploadResponse(BaseModel):
    success: bool
    url: Optional[str] = None
    error: Optional[str] = None
    metadata: dict

@mcp.tool
async def upload_image_to_s3(
    file_path: str,
    bucket_name: str,
    key: Optional[str] = None,
    optimize: bool = True,
    quality: int = 80,
    ctx: Context
) -> UploadResponse:
    """
    ë‹¨ì¼ ì´ë¯¸ì§€ íŒŒì¼ì„ S3ì— ì—…ë¡œë“œí•˜ê³  ê³µê°œ URLì„ ë°˜í™˜í•©ë‹ˆë‹¤.
    
    Args:
        file_path: ì—…ë¡œë“œí•  ì´ë¯¸ì§€ íŒŒì¼ ê²½ë¡œ
        bucket_name: S3 ë²„í‚·ëª…
        key: S3 ê°ì²´ í‚¤ (ì„ íƒì‚¬í•­, ë¯¸ì œê³µì‹œ ìë™ìƒì„±)
        optimize: ì´ë¯¸ì§€ ìµœì í™” ì—¬ë¶€
        quality: ì••ì¶• í’ˆì§ˆ (1-100)
        ctx: FastMCP Context (ìë™ ì£¼ì…)
    
    Returns:
        UploadResponse: ì—…ë¡œë“œ ê²°ê³¼, URL, ë©”íƒ€ë°ì´í„°
    """
    await ctx.info(f"Starting upload of {file_path} to {bucket_name}")
    # êµ¬í˜„ ë¡œì§...
```

### 2. batch_upload_images
```python
class BatchUploadResponse(BaseModel):
    success: bool
    urls: List[str] = []
    errors: List[str] = []
    total_files: int
    successful_uploads: int

@mcp.tool
async def batch_upload_images(
    file_paths: List[str],
    bucket_name: str,
    folder_prefix: Optional[str] = None,
    optimize: bool = True,
    ctx: Context
) -> BatchUploadResponse:
    """
    ì—¬ëŸ¬ ì´ë¯¸ì§€ë¥¼ ë³‘ë ¬ë¡œ S3ì— ì—…ë¡œë“œí•©ë‹ˆë‹¤.
    
    Args:
        file_paths: ì—…ë¡œë“œí•  ì´ë¯¸ì§€ íŒŒì¼ ê²½ë¡œ ë¦¬ìŠ¤íŠ¸
        bucket_name: S3 ë²„í‚·ëª…
        folder_prefix: S3 í´ë” í”„ë¦¬í”½ìŠ¤
        optimize: ì´ë¯¸ì§€ ìµœì í™” ì—¬ë¶€
        ctx: FastMCP Context (ìë™ ì£¼ì…)
    
    Returns:
        BatchUploadResponse: ì¼ê´„ ì—…ë¡œë“œ ê²°ê³¼
    """
    await ctx.info(f"Starting batch upload of {len(file_paths)} files")
    # êµ¬í˜„ ë¡œì§...
```

### 3. list_s3_buckets
```python
class BucketListResponse(BaseModel):
    success: bool
    buckets: List[str] = []
    error: Optional[str] = None

@mcp.tool
async def list_s3_buckets(ctx: Context) -> BucketListResponse:
    """
    ì‚¬ìš© ê°€ëŠ¥í•œ S3 ë²„í‚· ëª©ë¡ì„ ì¡°íšŒí•©ë‹ˆë‹¤.
    
    Args:
        ctx: FastMCP Context (ìë™ ì£¼ì…)
    
    Returns:
        BucketListResponse: ë²„í‚· ëª©ë¡
    """
    await ctx.info("Fetching S3 bucket list")
    # êµ¬í˜„ ë¡œì§...
```

## ğŸ–¼ï¸ ì´ë¯¸ì§€ ì²˜ë¦¬ ìš”êµ¬ì‚¬í•­

### ì§€ì› í¬ë§·
- PNG, JPG, JPEG, SVG, WebP
- ìë™ WebP ë³€í™˜ (ì˜µì…˜)
- ê¸°ë³¸ ì••ì¶• í’ˆì§ˆ 80%

### ì´ë¯¸ì§€ ìµœì í™” ê¸°ëŠ¥
```python
class ImageProcessor:
    def optimize_image(self, image_path: str, quality: int = 80) -> str:
        """ì´ë¯¸ì§€ ìµœì í™” ë° WebP ë³€í™˜"""
        
    def resize_image(self, image_path: str, max_width: int = 1920, max_height: int = 1080) -> str:
        """ì´ë¯¸ì§€ ë¦¬ì‚¬ì´ì§•"""
        
    def normalize_filename(self, filename: str) -> str:
        """URL ì•ˆì „ íŒŒì¼ëª… ìƒì„±"""
```

## â˜ï¸ AWS S3 ì—°ë™

### í•„ìˆ˜ IAM ê¶Œí•œ
```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": [
        "s3:PutObject",
        "s3:PutObjectAcl",
        "s3:GetObject",
        "s3:ListBucket"
      ],
      "Resource": [
        "arn:aws:s3:::your-bucket-name",
        "arn:aws:s3:::your-bucket-name/*"
      ]
    }
  ]
}
```

### S3 í´ë¼ì´ì–¸íŠ¸ êµ¬í˜„
```python
class S3Client:
    def __init__(self, region: str, bucket_name: str):
        self.s3_client = boto3.client('s3', region_name=region)
        self.bucket_name = bucket_name
    
    async def upload_file(self, file_path: str, key: str, metadata: dict = None) -> str:
        """íŒŒì¼ ì—…ë¡œë“œ ë° ê³µê°œ URL ë°˜í™˜"""
        
    async def upload_multiple(self, files: List[dict]) -> List[dict]:
        """ë³‘ë ¬ íŒŒì¼ ì—…ë¡œë“œ"""
```

## âš¡ ì„±ëŠ¥ ìµœì í™”

### ë¹„ë™ê¸° ì²˜ë¦¬
- `asyncio` ê¸°ë°˜ ë™ì‹œ ì—…ë¡œë“œ
- ìµœëŒ€ 5ê°œ íŒŒì¼ ë³‘ë ¬ ì²˜ë¦¬
- ë©€í‹°íŒŒíŠ¸ ì—…ë¡œë“œ (5MB ì´ìƒ)

### ì—ëŸ¬ ì²˜ë¦¬
- ì§€ìˆ˜ ë°±ì˜¤í”„ ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ ìë™ ì¬ì‹œë„
- Circuit Breaker íŒ¨í„´
- Graceful Degradation

## ğŸ”’ ë³´ì•ˆ ìš”êµ¬ì‚¬í•­

### í™˜ê²½ë³€ìˆ˜ ì„¤ì •
```bash
AWS_ACCESS_KEY_ID=your_access_key
AWS_SECRET_ACCESS_KEY=your_secret_key
AWS_REGION=ap-northeast-2
S3_BUCKET_NAME=your-bucket-name
```

### ë°ì´í„° ë³´ì•ˆ
- HTTPS/TLS 1.2 ì´ìƒ ì „ì†¡ ì•”í˜¸í™”
- S3 server-side encryption
- ìµœì†Œ ê¶Œí•œ ì›ì¹™ ì ìš©

## ğŸ“Š ë¡œê¹… ë° ëª¨ë‹ˆí„°ë§

### êµ¬ì¡°í™”ëœ ë¡œê¹…
```python
import logging
import json

logger = logging.getLogger(__name__)

def log_upload_result(file_path: str, success: bool, url: str = None, error: str = None):
    log_data = {
        "timestamp": datetime.utcnow().isoformat(),
        "file_path": file_path,
        "success": success,
        "url": url,
        "error": error
    }
    logger.info(json.dumps(log_data))
```

## ğŸ§ª í…ŒìŠ¤íŠ¸ ìš”êµ¬ì‚¬í•­

### ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
- ê° MCP Toolë³„ í…ŒìŠ¤íŠ¸
- ì´ë¯¸ì§€ ì²˜ë¦¬ ë¡œì§ í…ŒìŠ¤íŠ¸
- S3 í´ë¼ì´ì–¸íŠ¸ í…ŒìŠ¤íŠ¸
- ëª©í‘œ: 90% ì´ìƒ ì»¤ë²„ë¦¬ì§€

### í†µí•© í…ŒìŠ¤íŠ¸
- Claude Desktop ì—°ë™ í…ŒìŠ¤íŠ¸
- ì‹¤ì œ S3 ì—…ë¡œë“œ í…ŒìŠ¤íŠ¸
- ì—ëŸ¬ ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸

## ğŸ“¦ íŒ¨í‚¤ì§• ë° ë°°í¬

### pyproject.toml ì„¤ì •
```toml
[project]
name = "s3-upload-mcp-server"
version = "1.0.0"
description = "AWS S3 Upload MCP Server for Figma assets"
dependencies = [
    "fastmcp>=2.12.0",
    "boto3>=1.34.0",
    "Pillow>=10.0.0",
    "aiohttp>=3.9.0",
    "pydantic>=2.0.0"
]

[project.scripts]
s3-upload-mcp-server = "s3_upload_mcp.server:main"
```

### FastMCP ì„œë²„ ì‹¤í–‰
```python
# server.py
from fastmcp import FastMCP
from s3_upload_mcp.tools import upload_image_to_s3, batch_upload_images, list_s3_buckets

mcp = FastMCP("S3 Upload Server")

# ë„êµ¬ ë“±ë¡
mcp.tool(upload_image_to_s3)
mcp.tool(batch_upload_images)
mcp.tool(list_s3_buckets)

if __name__ == "__main__":
    mcp.run()  # STDIO transport (ê¸°ë³¸)
    # ë˜ëŠ” HTTP: mcp.run(transport="http", host="127.0.0.1", port=8000)
```

### Claude Desktop ì„¤ì •
```json
{
  "mcpServers": {
    "s3-upload": {
      "command": "uv",
      "args": ["run", "s3-upload-mcp-server"],
      "env": {
        "AWS_REGION": "ap-northeast-2",
        "S3_BUCKET_NAME": "figma-assets-bucket"
      }
    }
  }
}
```

## ğŸ¯ ê°œë°œ ê°€ì´ë“œë¼ì¸

### ì½”ë“œ ìŠ¤íƒ€ì¼
- PEP 8 ì¤€ìˆ˜
- Type hints í•„ìˆ˜ ì‚¬ìš©
- Docstring Google ìŠ¤íƒ€ì¼
- ë¹„ë™ê¸° í•¨ìˆ˜ëŠ” `async/await` ì‚¬ìš©

### ì—ëŸ¬ ì²˜ë¦¬
- ëª¨ë“  ì™¸ë¶€ API í˜¸ì¶œì— try-catch ì ìš©
- ì‚¬ìš©ì ì¹œí™”ì  ì—ëŸ¬ ë©”ì‹œì§€
- ë¡œê¹…ì„ í†µí•œ ë””ë²„ê¹… ì •ë³´ ì œê³µ

### ì„±ëŠ¥ ê³ ë ¤ì‚¬í•­
- ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ 100MB ì´í•˜ ìœ ì§€
- CPU ì‚¬ìš©ë¥  ë‹¨ì¼ ì½”ì–´ 50% ì´í•˜
- 1MB ì´ë¯¸ì§€ ê¸°ì¤€ 3ì´ˆ ì´ë‚´ ì—…ë¡œë“œ

## ğŸš€ ë°°í¬ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] ëª¨ë“  MCP Tools êµ¬í˜„ ì™„ë£Œ
- [ ] ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ 90% ì´ìƒ
- [ ] í†µí•© í…ŒìŠ¤íŠ¸ í†µê³¼
- [ ] Claude Desktop ì—°ë™ í™•ì¸
- [ ] ì½”ë“œ ë¦¬ë·° ìŠ¹ì¸
- [ ] ì •ì  ë¶„ì„ ë„êµ¬ í†µê³¼
- [ ] ë³´ì•ˆ ìŠ¤ìº” í†µê³¼
- [ ] ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ê¸°ì¤€ ë‹¬ì„±

## ğŸ“ ì§€ì› ë° ë¬¸ì˜

í”„ë¡œì íŠ¸ ê´€ë ¨ ë¬¸ì˜ì‚¬í•­ì´ë‚˜ ì´ìŠˆê°€ ìˆìœ¼ì‹œë©´ ì–¸ì œë“ ì§€ ë§ì”€í•´ ì£¼ì„¸ìš”. 
ì´ ê·œì¹™ì„ ë”°ë¼ ê°œë°œí•˜ì‹œë©´ ì•ˆì •ì ì´ê³  í™•ì¥ ê°€ëŠ¥í•œ MCP ì„œë²„ë¥¼ êµ¬ì¶•í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
